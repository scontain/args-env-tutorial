# run next steps in container in a Kubernetes cluster with a local
# LAS and CAS already installed

# show the K8s manifest
cat pod_manifest.yaml 

# create the pod
kubectl apply -f pod_manifest.yaml 
kubectl get pods

# execute the commands inside of the container
kubectl exec -it args-env-tutorial    -- bash


# clone the repo

apk add git
mkdir /work
cd /work
git clone https://github.com/scontain/args-env-tutorial.git
cd args-env-tutorial/

# reduce log level
export SCONE_LOG=warning
export SCONE_MODE=hw
unset SCONE_VERSION

# attest CAS
scone cas attest $SCONE_CAS_ADDR --only_for_testing-debug --only_for_testing-ignore-signer --only_for_testing-trust-any --accept-configuration-needed --accept-sw-hardening-needed --accept-group-out-of-date
scone cas list

# recompile binaries

scone-gcc print-arg-env.c -g -O3 -o scone-print-arg-env
scone-gcc print-access-token.c  -o print-access-token

